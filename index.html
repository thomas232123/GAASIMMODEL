<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAA Championship Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .header {
            background: linear-gradient(45deg, #009639, #00b33c);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .content {
            padding: 20px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section h2 {
            color: #009639;
            font-size: 18px;
            margin-bottom: 15px;
            border-bottom: 2px solid #009639;
            padding-bottom: 5px;
        }

        .win-percentages {
            display: grid;
            gap: 10px;
        }

        .team-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #009639;
        }

        .team-name {
            font-weight: 600;
            color: #333;
        }

        .percentage {
            font-weight: 700;
            color: #009639;
            font-size: 16px;
        }

        .buttons {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .btn-primary {
            background: #009639;
            color: white;
        }

        .btn-primary:hover {
            background: #007d30;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .input-group {
            margin: 15px 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #009639;
        }

        .result-container {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }

        .match-result {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #009639;
        }

        .round-title {
            font-weight: 700;
            color: #009639;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .match {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .match:last-child {
            border-bottom: none;
        }

        .match-teams {
            flex: 1;
        }

        .winner {
            font-weight: 700;
            color: #009639;
        }

        .champion {
            text-align: center;
            padding: 20px;
            background: linear-gradient(45deg, #009639, #00b33c);
            color: white;
            border-radius: 10px;
            margin-top: 15px;
        }

        .champion h3 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .error {
            background: #dc3545;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #009639;
        }

        .tier-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            margin: 10px 0;
        }

        .tier-contender {
            background: #28a745;
            color: white;
        }

        .tier-strong {
            background: #007bff;
            color: white;
        }

        .tier-dark {
            background: #6f42c1;
            color: white;
        }

        .tier-outside {
            background: #fd7e14;
            color: white;
        }

        .tier-long {
            background: #dc3545;
            color: white;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 5px;
            height: 20px;
            margin: 5px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #009639, #00b33c);
            transition: width 0.3s ease;
        }

        .bracket-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }

        .bracket-round {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #009639;
        }

        .bracket-match {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid transparent;
        }

        .bracket-match.upset {
            border-left-color: #dc3545;
            background: #fff5f5;
        }

        .bracket-teams {
            flex: 1;
        }

        .bracket-winner {
            font-weight: 700;
            color: #009639;
        }

        .upset-badge {
            background: #dc3545;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        

        .tournament-bracket {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin: 20px 0;
            background: white;
            padding: 20px;
            border-radius: 10px;
        }

        .bracket-stage {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .bracket-stage h4 {
            color: #009639;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .bracket-matches {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            width: 100%;
        }

        .bracket-match-card {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            min-width: 280px;
            max-width: 320px;
            text-align: center;
            position: relative;
        }

        .bracket-match-card.upset {
            border-color: #dc3545;
            background: #fff5f5;
        }

        .bracket-match-teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 8px;
            background: white;
            border-radius: 6px;
        }

        .bracket-team {
            font-weight: 600;
            flex: 1;
        }

        .bracket-team.winner {
            color: #009639;
            font-weight: 700;
        }

        .bracket-score {
            font-weight: 700;
            margin: 0 10px;
            color: #666;
        }

        .bracket-vs {
            color: #999;
            font-size: 14px;
            margin: 5px 0;
        }

        .bracket-final {
            background: linear-gradient(45deg, #009639, #00b33c);
            color: white;
            border: none;
            margin-top: 20px;
        }

        .bracket-final .bracket-match-teams {
            background: rgba(255,255,255,0.1);
        }

        .bracket-champion {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
        }

        .team-dublin { background: #87ceeb; color: #000080; }
        .team-kerry { background: #00a651; color: #ffd700; }
        .team-cork { background: #dc143c; color: white; }
        .team-donegal { background: #ffd700; color: #00a651; }
        .team-galway { background: #800000; color: white; }
        .team-armagh { background: #ff8c00; color: white; }
        .team-tyrone { background: white; color: #dc143c; }
        .team-monaghan { background: white; color: #0066cc; }
        .team-meath { background: #00a651; color: #ffd700; }
        .team-down { background: #dc143c; color: black; }
        .team-cavan { background: #0066cc; color: white; }
        .team-louth { background: #dc143c; color: white; }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 20px;
            }

            .content {
                padding: 15px;
            }

            .btn {
                padding: 12px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÜ GAA Championship Simulator</h1>
            <p>10,000 simulations completed</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>üèÜ Championship Win Probabilities</h2>
                <div class="win-percentages">
                    {% for team_data in win_percentages %}
                    <div class="team-row">
                        <span class="team-name">{{ team_data.team }}</span>
                        <span class="percentage">{{ team_data.percentage }}%</span>
                    </div>
                    {% endfor %}
                </div>
            </div>

            

            <div class="section">
                <h2>üéØ Team-Specific Analysis</h2>
                <div class="input-group">
                    <label for="team-select">Select Team:</label>
                    <select id="team-select">
                        <option value="">Choose a team...</option>
                        {% for team in teams %}
                        <option value="{{ team }}">{{ team }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div style="display: grid; gap: 10px; grid-template-columns: 1fr 1fr;">
                    <button class="btn btn-primary" onclick="viewTeamSummary()">Team Performance Summary</button>
                    <button class="btn btn-secondary" onclick="viewTeamWins()">View Team Wins</button>
                </div>
                <div id="team-result-container" class="result-container">
                    <!-- Team analysis results will be displayed here -->
                </div>
            </div>
            
            <div class="section">
                <h2>‚öîÔ∏è Head-to-Head Comparison</h2>
                <div class="input-group">
                    <label for="team1-select">Select Team 1:</label>
                    <select id="team1-select">
                        <option value="">Choose a team...</option>
                        {% for team in teams %}
                        <option value="{{ team }}">{{ team }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="input-group">
                    <label for="team2-select">Select Team 2:</label>
                    <select id="team2-select">
                        <option value="">Choose a team...</option>
                        {% for team in teams %}
                        <option value="{{ team }}">{{ team }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button class="btn btn-primary" onclick="viewHeadToHead()">Compare Teams</button>
                <div id="head-to-head-result-container" class="result-container">
                    <!-- Head-to-head results will be displayed here -->
                </div>
            </div>

            <div class="section">
                <h2>üèÜ Tournament Bracket</h2>
                <div class="input-group">
                    <label for="bracket-sim-input">View Bracket for Simulation:</label>
                    <input type="number" id="bracket-sim-input" min="1" max="10000" placeholder="Enter simulation number">
                </div>
                <button class="btn btn-primary" onclick="viewBracket()">View Tournament Bracket</button>
                <div id="bracket-result-container" class="result-container">
                    <!-- Bracket results will be displayed here -->
                </div>
            </div>

            <div class="buttons">
                <button class="btn btn-secondary" onclick="viewRoundStats()">üìà View Round Statistics</button>
                <button class="btn btn-primary" onclick="rerunSimulations()">üîÑ Re-run All Simulations</button>
            </div>

            <div id="result-container" class="result-container">
                <!-- Results will be displayed here -->
            </div>
        </div>
    </div>

    <script>
        function showLoading() {
            const container = document.getElementById('result-container');
            container.innerHTML = '<div class="loading">Loading...</div>';
            container.style.display = 'block';
        }

        function showError(message) {
            const container = document.getElementById('result-container');
            container.innerHTML = `<div class="error">${message}</div>`;
            container.style.display = 'block';
        }

        

        function viewTeamWins() {
            const team = document.getElementById('team-select').value;
            if (!team) {
                showTeamError('Please select a team');
                return;
            }

            showTeamLoading();

            fetch(`/team_wins/${team}`)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        showTeamError(data.error);
                        return;
                    }

                    let html = `<h3>‚úÖ ${data.team} Analysis</h3>`;
                    html += `<p><strong>Total Wins:</strong> ${data.total_wins} out of 10,000 simulations</p>`;
                    html += `<p><strong>Win Rate:</strong> ${(data.total_wins / 100).toFixed(2)}%</p>`;

                    if (data.simulation_ids.length > 0) {
                        html += '<h4>Sample Winning Simulations:</h4>';
                        html += '<div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">';
                        html += data.simulation_ids.slice(0, 20).join(', ');
                        if (data.simulation_ids.length > 20) {
                            html += '...';
                        }
                        html += '</div>';
                        html += '<p style="margin-top: 10px; font-size: 14px; color: #666;">Use the simulation viewer above to see detailed results for any of these numbers.</p>';
                    } else {
                        html += '<p>This team did not win any simulations.</p>';
                    }

                    document.getElementById('team-result-container').innerHTML = html;
                })
                .catch(error => {
                    showTeamError('Error loading team data');
                });
        }

        function viewTeamSummary() {
            const team = document.getElementById('team-select').value;
            if (!team) {
                showTeamError('Please select a team');
                return;
            }

            showTeamLoading();

            fetch(`/team_summary/${team}`)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        showTeamError(data.error);
                        return;
                    }

                    const tierClass = data.tier.toLowerCase().replace(/\s+/g, '-').replace('championship-contender', 'contender');

                    let html = `<h3>üìä ${data.team} Performance Summary</h3>`;

                    html += '<div class="summary-card">';
                    html += `<h4>üèÜ Overall Profile</h4>`;
                    html += `<p><strong>Power Rating:</strong> ${data.power_rating} (Ranked ${data.ranking})</p>`;
                    html += `<div class="tier-badge tier-${tierClass}">${data.tier}</div>`;
                    html += `<p><strong>Total Championships:</strong> ${data.total_wins} out of 10,000 simulations</p>`;
                    html += '</div>';

                    html += '<div class="summary-card">';
                    html += '<h4>üìà Round-by-Round Success Rate</h4>';

                    const rounds = [
                        ['Preliminary QF', data.round_performance.prelim],
                        ['Quarter-Finals', data.round_performance.quarter_final],
                        ['Semi-Finals', data.round_performance.semi_final],
                        ['Finals', data.round_performance.final],
                        ['Championship', data.round_performance.championship]
                    ];

                    rounds.forEach(([round, percentage]) => {
                        html += `<div style="margin: 10px 0;">`;
                        html += `<div style="display: flex; justify-content: space-between;">`;
                        html += `<span>${round}</span><span><strong>${percentage}%</strong></span>`;
                        html += `</div>`;
                        html += `<div class="progress-bar">`;
                        html += `<div class="progress-fill" style="width: ${percentage}%"></div>`;
                        html += `</div>`;
                        html += `</div>`;
                    });

                    html += '</div>';

                    if (data.best_matchups.length > 0) {
                        html += '<div class="summary-card">';
                        html += '<h4>‚úÖ Best Matchups</h4>';
                        data.best_matchups.forEach(([opponent, winRate]) => {
                            html += `<div class="match">`;
                            html += `<div class="match-teams">vs ${opponent}</div>`;
                            html += `<div class="winner">${winRate}% win rate</div>`;
                            html += `</div>`;
                        });
                        html += '</div>';
                    }

                    if (data.worst_matchups.length > 0) {
                        html += '<div class="summary-card">';
                        html += '<h4>‚ö†Ô∏è Tough Matchups</h4>';
                        data.worst_matchups.forEach(([opponent, winRate]) => {
                            html += `<div class="match">`;
                            html += `<div class="match-teams">vs ${opponent}</div>`;
                            html += `<div style="color: #dc3545; font-weight: 600;">${winRate}% win rate</div>`;
                            html += `</div>`;
                        });
                        html += '</div>';
                    }

                    document.getElementById('team-result-container').innerHTML = html;
                })
                .catch(error => {
                    showTeamError('Error loading team summary');
                });
        }

        function viewHeadToHead() {
            const team1 = document.getElementById('team1-select').value;
            const team2 = document.getElementById('team2-select').value;

            if (!team1 || !team2) {
                showHeadToHeadError('Please select both teams');
                return;
            }

            if (team1 === team2) {
                showHeadToHeadError('Please select two different teams');
                return;
            }

            showHeadToHeadLoading();

            fetch(`/head_to_head/${team1}/${team2}`)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        showHeadToHeadError(data.error);
                        return;
                    }

                    let html = `<h3>‚öîÔ∏è ${data.team1} vs ${data.team2} Head-to-Head</h3>`;

                    if (data.total_matches === 0) {
                        html += '<p>These teams never played each other in any simulation.</p>';
                    } else {
                        html += `<div class="match-result">`;
                        html += `<h4>üìä Overall Statistics</h4>`;
                        html += `<p><strong>Total Matches:</strong> ${data.total_matches}</p>`;
                        html += `<div class="team-row">`;
                        html += `<span class="team-name">${data.team1}</span>`;
                        html += `<span class="percentage">${data.team1_wins} wins (${data.team1_win_rate}%)</span>`;
                        html += `</div>`;
                        html += `<div class="team-row">`;
                        html += `<span class="team-name">${data.team2}</span>`;
                        html += `<span class="percentage">${data.team2_wins} wins (${data.team2_win_rate}%)</span>`;
                        html += `</div>`;
                        html += `<p><strong>Expected:</strong> ${data.team1} ${data.expected_team1_prob}% vs ${data.team2} ${data.expected_team2_prob}%</p>`;
                        html += `</div>`;

                        html += `<div class="match-result">`;
                        html += `<h4>üèê Recent Matchups (Sample)</h4>`;

                        data.matchups.slice(0, 20).forEach(match => {
                            html += `<div class="match">`;
                            html += `<div class="match-teams">Sim ${match.simulation_id} - ${match.round}</div>`;
                            html += `<div class="match-teams">${match.team_a} ${match.score_a} vs ${match.team_b} ${match.score_b}</div>`;
                            html += `<div class="winner">${match.winner} wins</div>`;
                            html += `</div>`;
                        });

                        if (data.matchups.length > 20) {
                            html += `<p><em>Showing first 20 of ${data.matchups.length} total matches</em></p>`;
                        }

                        html += `</div>`;
                    }

                    document.getElementById('head-to-head-result-container').innerHTML = html;
                })
                .catch(error => {
                    showHeadToHeadError('Error loading head-to-head data');
                });
        }

        function viewRoundStats() {
            showLoading();

            fetch('/round_stats')
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        showError(data.error);
                        return;
                    }

                    let html = '<h3>üìà Round Appearance Statistics</h3>';

                    ['prelim', 'qf', 'sf', 'final'].forEach((round, index) => {
                        const roundNames = ['Preliminary Quarter-Finals', 'Quarter-Finals', 'Semi-Finals', 'Finals'];
                        const roundEmojis = ['üü¢', 'üèÅ', 'üî•', 'üèÜ'];

                        html += '<div class="match-result">';
                        html += `<div class="round-title">${roundEmojis[index]} ${roundNames[index]}</div>`;

                        data[round].forEach(team => {
                            html += `<div class="match">`;
                            html += `<div class="match-teams">${team.team}</div>`;
                            html += `<div class="winner">${team.percentage}%</div>`;
                            html += `</div>`;
                        });

                        html += '</div>';
                    });

                    document.getElementById('result-container').innerHTML = html;
                })
                .catch(error => {
                    showError('Error loading round statistics');
                });
        }

        function rerunSimulations() {
            showLoading();

            fetch('/rerun_simulations', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Update the win percentages on the page
                    const winPercentagesDiv = document.querySelector('.win-percentages');
                    let html = '';
                    data.win_percentages.forEach(team => {
                        html += `<div class="team-row">`;
                        html += `<span class="team-name">${team.team}</span>`;
                        html += `<span class="percentage">${team.percentage}%</span>`;
                        html += `</div>`;
                    });
                    winPercentagesDiv.innerHTML = html;

                    document.getElementById('result-container').innerHTML = 
                        `<div class="success-message">‚úÖ ${data.message}</div>`;
                } else {
                    showError('Failed to rerun simulations');
                }
            })
            .catch(error => {
                showError('Error rerunning simulations');
            });
        }

        function viewBracket() {
            const simId = document.getElementById('bracket-sim-input').value;
            if (!simId || simId < 1 || simId > 10000) {
                showBracketError('Please enter a valid simulation number (1-10000)');
                return;
            }

            showBracketLoading();

            fetch(`/bracket_visualization/${simId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        showBracketError(data.error);
                        return;
                    }

                    let html = `<h3>üèÜ Tournament Bracket - Simulation #${simId}</h3>`;
                    html += '<div class="tournament-bracket">';

                    // Preliminary Quarter-Finals
                    html += '<div class="bracket-stage">';
                    html += '<h4>üü¢ Preliminary Quarter-Finals</h4>';
                    html += '<div class="bracket-matches">';
                    data.prelim.forEach(match => {
                        const upsetClass = match.upset ? ' upset' : '';
                        html += `<div class="bracket-match-card${upsetClass}">`;
                        if (match.upset) {
                            html += '<span class="upset-badge">UPSET</span>';
                        }
                        html += `<div class="bracket-match-teams">`;
                        html += `<div class="bracket-team${match.winner === match.team_a ? ' winner' : ''}">${match.team_a}</div>`;
                        html += `<div class="bracket-score">${match.score_a}</div>`;
                        html += `</div>`;
                        html += `<div class="bracket-vs">vs</div>`;
                        html += `<div class="bracket-match-teams">`;
                        html += `<div class="bracket-team${match.winner === match.team_b ? ' winner' : ''}">${match.team_b}</div>`;
                        html += `<div class="bracket-score">${match.score_b}</div>`;
                        html += `</div>`;
                        html += `<div style="margin-top: 10px; font-weight: 700; color: #009639;">${match.winner} ADVANCES</div>`;
                        html += `</div>`;
                    });
                    html += '</div></div>';

                    // Quarter-Finals
                    html += '<div class="bracket-stage">';
                    html += '<h4>üèÅ Quarter-Finals</h4>';
                    html += '<div class="bracket-matches">';
                    data.quarter_finals.forEach(match => {
                        const upsetClass = match.upset ? ' upset' : '';
                        html += `<div class="bracket-match-card${upsetClass}">`;
                        if (match.upset) {
                            html += '<span class="upset-badge">UPSET</span>';
                        }
                        html += `<div class="bracket-match-teams">`;
                        html += `<div class="bracket-team${match.winner === match.team_a ? ' winner' : ''}">${match.team_a}</div>`;
                        html += `<div class="bracket-score">${match.score_a}</div>`;
                        html += `</div>`;
                        html += `<div class="bracket-vs">vs</div>`;
                        html += `<div class="bracket-match-teams">`;
                        html += `<div class="bracket-team${match.winner === match.team_b ? ' winner' : ''}">${match.team_b}</div>`;
                        html += `<div class="bracket-score">${match.score_b}</div>`;
                        html += `</div>`;
                        html += `<div style="margin-top: 10px; font-weight: 700; color: #009639;">${match.winner} ADVANCES</div>`;
                        html += `</div>`;
                    });
                    html += '</div></div>';

                    // Semi-Finals
                    html += '<div class="bracket-stage">';
                    html += '<h4>üî• Semi-Finals</h4>';
                    html += '<div class="bracket-matches">';
                    data.semi_finals.forEach(match => {
                        const upsetClass = match.upset ? ' upset' : '';
                        html += `<div class="bracket-match-card${upsetClass}">`;
                        if (match.upset) {
                            html += '<span class="upset-badge">UPSET</span>';
                        }
                        html += `<div class="bracket-match-teams">`;
                        html += `<div class="bracket-team${match.winner === match.team_a ? ' winner' : ''}">${match.team_a}</div>`;
                        html += `<div class="bracket-score">${match.score_a}</div>`;
                        html += `</div>`;
                        html += `<div class="bracket-vs">vs</div>`;
                        html += `<div class="bracket-match-teams">`;
                        html += `<div class="bracket-team${match.winner === match.team_b ? ' winner' : ''}">${match.team_b}</div>`;
                        html += `<div class="bracket-score">${match.score_b}</div>`;
                        html += `</div>`;
                        html += `<div style="margin-top: 10px; font-weight: 700; color: #009639;">${match.winner} ADVANCES</div>`;
                        html += `</div>`;
                    });
                    html += '</div></div>';

                    // Final - always use winner's county colors
                    const final = data.final;
                    const winnerClass = `team-${final.winner.toLowerCase()}`;
                    html += '<div class="bracket-stage">';
                    html += '<h4>üèÜ All-Ireland Final</h4>';
                    html += `<div class="bracket-match-card bracket-final ${winnerClass}">`;
                    if (final.upset) {
                        html += '<span class="upset-badge">UPSET</span>';
                    }
                    html += `<div class="bracket-match-teams">`;
                    html += `<div class="bracket-team${final.winner === final.team_a ? ' winner' : ''}">${final.team_a}</div>`;
                    html += `<div class="bracket-score">${final.score_a}</div>`;
                    html += `</div>`;
                    html += `<div class="bracket-vs">vs</div>`;
                    html += `<div class="bracket-match-teams">`;
                    html += `<div class="bracket-team${final.winner === final.team_b ? ' winner' : ''}">${final.team_b}</div>`;
                    html += `<div class="bracket-score">${final.score_b}</div>`;
                    html += `</div>`;
                    html += `<div class="bracket-champion">üèÜ ${final.winner} WINS SAM MAGUIRE! üèÜ</div>`;
                    html += `</div>`;
                    html += '</div>';

                    html += '</div>';

                    document.getElementById('bracket-result-container').innerHTML = html;
                })
                .catch(error => {
                    showBracketError('Error loading bracket data');
                });
        }

        

        

        function showTeamLoading() {
            const container = document.getElementById('team-result-container');
            container.innerHTML = '<div class="loading">Loading...</div>';
            container.style.display = 'block';
        }

        function showTeamError(message) {
            const container = document.getElementById('team-result-container');
            container.innerHTML = `<div class="error">${message}</div>`;
            container.style.display = 'block';
        }

        function showHeadToHeadLoading() {
            const container = document.getElementById('head-to-head-result-container');
            container.innerHTML = '<div class="loading">Loading...</div>';
            container.style.display = 'block';
        }

        function showHeadToHeadError(message) {
            const container = document.getElementById('head-to-head-result-container');
            container.innerHTML = `<div class="error">${message}</div>`;
            container.style.display = 'block';
        }

        function showBracketLoading() {
            const container = document.getElementById('bracket-result-container');
            container.innerHTML = '<div class="loading">Loading...</div>';
            container.style.display = 'block';
        }

        function showBracketError(message) {
            const container = document.getElementById('bracket-result-container');
            container.innerHTML = `<div class="error">${message}</div>`;
            container.style.display = 'block';
        }

        // Allow Enter key to trigger bracket view
        document.addEventListener('DOMContentLoaded', function() {
            const bracketInput = document.getElementById('bracket-sim-input');
            if (bracketInput) {
                bracketInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        viewBracket();
                    }
                });
            }
        });
    </script>
</body>
</html>
